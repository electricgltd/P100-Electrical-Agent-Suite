# P100 Electrical Agent Suite

Parent/child Copilot Studio agents for an NICEIC electrical contractor:
- **EA** (Electrical Assistant) – orchestrates workflows
- **PA** (Planning Assistant)
- **DCA** (Design & Costing Assistant)

## Planning Phase Implementation

This repository now includes a comprehensive planning phase system with:

### 🎯 Issue Templates
- **Planning Phase (Parent Issue)** - Creates parent-level planning issues that trigger workflow actions
- **Agent-assisted Sub-issue** - Creates sub-issues that can be completed by automated agents

### 🏷️ Label System
- `Planning` - Marks issues as planning phases
- `agent: allowed` - Opt-in label to permit automated agent action
- `agent: generated` - Applied to PRs created by automated agents
- `agent: approved` - Applied by humans after reviewing agent work
- `agent: denied` - Blocks automated agent action
- `sub-issue` - Links issues to parent planning phases

### ⚙️ Automated Workflows
- **Planning Phase Workflow** - Handles planning issues and agent sub-issues
- **Agent PR Review** - Validates agent-generated PRs and enforces safety policies

### 🔒 Safety Features
- Human approval required for all agent work
- File scope validation for agent actions
- Security scanning of agent-generated changes
- Audit trail with `[agent-generated]` commit markers
- Branch protection and CI/CD integration

## Structure
- `/agents` – grounding files and agent docs (EA/PA/DCA)
- `/docs` – orchestration notes, templates, planning phase config
- `/flows` – Power Automate flow definitions/docs
- `/grounding-files` – Copilot Space context pack and operational documentation
- `/solutions` – unpacked Dataverse solution source
- `/scripts` – ALM automation (pack/unpack)
- `/env` – WinGet configuration and local-only samples
- `/.github/ISSUE_TEMPLATE/` – Planning phase and agent sub-issue templates
- `/.github/workflows/` – Planning phase automation workflows

## Quick Start: Using Planning Phase

### Creating a Planning Phase Issue
1. Go to **Issues** → **New Issue**
2. Select **Planning Phase (Parent Issue)** template
3. Fill in planning scope, priority, and areas involved
4. Add `Planning` and appropriate agent label (e.g., `agent:PA`)
5. Submit - this triggers branch creation and workflow automation

### Creating Agent Sub-issues
1. Go to **Issues** → **New Issue** 
2. Select **Agent-assisted Sub-issue** template
3. Link to parent issue and define task scope
4. **Important**: Define file/path scope for agent work
5. To authorize agent work, add `agent: allowed` label

### Safety Checklist for Agent Work
- ✅ Agent limited to specified file scope only
- ✅ All commits include `[agent-generated]` marker
- ✅ PR opened as Draft with `AUTOGENERATED-BY-AGENT: true`
- ✅ Human review and approval required before merge
- ✅ Security scans and CI must pass

> **Public-safety**: no secrets are stored in this repo. Use **GitHub Secrets** and local `.env` files (excluded by `.gitignore`).

## Local Git GUI recommendation

If you prefer a powerful desktop GUI for repository operations, GitKraken is a good option — it provides an intuitive commit graph, interactive rebases, conflict resolution UI, and easy remote integrations. For in-container development and PR workflows we recommend using VS Code with the GitLens and GitHub Pull Requests extensions (both are included in the devcontainer configuration).

